#!/bin/sh

PLAYBACK_DEVICE=ploop
CAPPTURE_DEVICE=cloop
PLAYBACK_CLIENT=alsa2jack
CAPPTURE_CLIENT=jack2alsa
Q=2


# loading kernel module needed for loop device
sudo modprobe snd-aloop

# loop client creation
/usr/bin/alsa_out -j $PLAYBACK_CLIENT -d $PLAYBACK_DEVICE -q $Q &
/usr/bin/alsa_in -j $CAPPTURE_CLIENT -d $CAPPTURE_DEVICE -q $Q &

# give it some time before connecting to system ports
sleep 1

# alsa capture -> jack playback
jack_connect $CAPPTURE_CLIENT:capture_1 system:playback_1
jack_connect $CAPPTURE_CLIENT:capture_2 system:playback_2

# jack capture -> alsa playback
jack_connect system:capture_1 $PLAYBACK_CLIENT:playback_1
jack_connect system:capture_2 $PLAYBACK_CLIENT:playback_2
